# **SPIKE RBD-ACE2 PROTEIN-PROTEIN INTERFACE ANALYSIS**

This is the README file for the project carried out on the analysis of
energies between the **receptor-binding domain (RBD)** of the SARS-CoV-2
spike protein and its receptor, **angiotensin-converting enzyme
(ACE2)**. In this document, you will find a detailed explanation of all
the files included in the final delivery of the work, as well as
instructions on how to perform the analysis.

The organization of this document is as follows. First, a detailed
explanation of all the documents containing the necessary data for
conducting the specific study will be provided. Subsequently, a brief
explanation of the codes used will be given, detailing the required
inputs and the provided outputs. Finally, the report will be
discussedVas well as the final [outputs].

------------------------------------------------------------------------

## [Index]

1.  [Included Files](#included)

    -   [Protein structure](#prostr)
    -   [Parameters & Libraries](#parlib)

2.  [Code](#codes)

    -   [Preparation & Data Curation](#prep)
    -   [Determine Interface Residues](#inre)
    -   [Computing Interaction Energies](#inen)
    -   [Alanine-Scanning](#alsc)

3.  [Results](#results)

4.  [Documentation](#doc)

5.  [Authors](#authors)

------------------------------------------------------------------------

## [Included Files] {#included}

In this section, all the documents and data necessary to carry out the
project will be discussed.

### Protein structures {#prostr}

`6m0j.cif`: File containing the structure of the complex formed by our
proteins of interest, downloaded directly from:
<https://www.rcsb.org/structure/6M0J>.

*Note: file `6m0j_fixed.pdb` (which contains the clean and curated
structure of the complex formed by our proteins of interest) it's the
output generated when running the "PREPARATION & DATA CURATION" section
of the script and it's also the structure that we will work with in
further steps. So it doesn't need to be provided by the user as output
when running the script; instead, it'll be automatically generated and
loaded during the script execution.*

### Parameters & Libraries {#parlib}

`aaLib_2.lib` Contains a table with information about the charge and
type of each atom of each residue.

-   Important: some warnings may appear when using library 'aaLib_2.lib'
    at step "COMPUTING INTERACTION ENERGIES". This is due to the fact
    that, when a structure is downloaded from the PDB, some atoms may
    appear with a different name than the one included in 'aaLib_2.lib'.
    In order to solve the warning(s), the file needs to be manually
    updated so the names are not different.

`vdwprm` This file includes a table with all the necessary parameters to
calculate the Van der Waals interaction energy.

`NACCESS` Directory containing the `naccess` executable used to
calculate solvation energies. If it's the first time running the
pipeline, make sure to enter the directory and install `naccess` (you
can follow the instructions inside the file `BioPhys_README` ).

------------------------------------------------------------------------

## [Code] {#code}

At the outset of the code, one encounters a code block labeled
`customize parameters` . This is the section where the variables
mentioned must be explicitly defined by the user to enable the proper
functioning of the code. Positioned at the beginning of the code, this
segment is designed for pre-execution modification, obviating the need
to alter variables midway through execution.

It is important to note that the **`base_path`** refers to the path
where the PDB structure is located, along with the aforementioned
parameters and libraries. However, the outputs generated by the code are
saved in the directory where the Jupyter notebook(code) is situated.

### Preparation & Data Curation {#prep}

Within this section, a curation of the provided structure takes place.
More specifically, non-contributing chains are excluded, and heteroatoms
(defined as any atom not belonging to the residues) are removed.
Subsequently, quality controls are implemented on the new structures.
Additionally, missing side-chains, hydrogen atoms, and atom charges are
incorporated. As an output from this section, an file is generated
containing the curated structure.

### Determine Interface Residues {#inre}

In this step, the interface residues of the curated structure (i.e.
output of the preceding section) are identified within a specified
distance. This distance is defined in the `customize parameters` section
and must be determined using `PyMol`. No external file is generated as
output for this section; however, a variable called 'interface' is
created, containing a dictionary where the keys are the name of the
different chains of the structure and the associated values are a set
containing the interface residues located on that specific chain.
'interface' variable will be used in the subsequent sections.

### Computing Interaction Energies {#inen}

In this section, the interaction energies are computed. On one hand, the
interaction energies concerning the interface residues (determined in
the previous step) are calculated, and on the other hand, the
computation is performed considering all residues. This separation is
made in order to conduct an analysis on the importance of interface
residues. As output from this section, two `.csv` files are generated:
one detailing the energy results for all residues (`energies_all.csv`)
and the other with the energies obtained by exclusively considering the
interface residues (`energies_interface.csv`).

### Alanine-Scanning {#alsc}

In this final code segment, the alanine scanning is conducted to assess
the importance of each interface residue in terms of the interaction.
The output from this process is a `.csv` document containing all the
energy differences after completing the study (`ala_scanning.csv`).

------------------------------------------------------------------------

## [Results] 

`energies_all.csv` File generated after running `final_script.ipynb`.
Contains a table with all the energies (electrostatic, Van der Waals,
solvation of complex, solvation of chain A, solvation of chain G and
total) of all the residues of the complex.

`energies_interface.csv` File generated after running
`final_script.ipynb`. Contains a table with all the energies
(electrostatic, Van der Waals, solvation of complex, solvation of chain
A, solvation of chain G and total) of all the residues that form the
interface complex.

`ala_scanning.csv` File generated after running `final_script.ipynb`.
Contains a table with all the energies for all residues after being
replaced by ALA (one by one) that form the interface complex. There's a
row for each residue and a column for each energy.

------------------------------------------------------------------------

## [Documentation] {#doc}

Additional information can be found in the files:

`USAGE_EXAMPLE(our_results)`: folder in github repository with our
results and report.

-   `report`: document inside the `USAGE_EXAMPLE(our_results)` folder
    containing information about the whole project (including
    methodology, results and conclusions).

------------------------------------------------------------------------

## [Authors] {#authors}

**Ricard Garcia Isern** \| [Contact me](ricard.garcia@alum.esci.upf.edu)

**Antonio Arcas i Pons** \| [Contact
me](antonio.arcas@alum.esci.upf.edu)

**NÃºria Cardona Vilar** \| [Contact me](nuria.cardona@alum.esci.upf.edu)

